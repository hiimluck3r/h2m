---
- name: Install nginx
  kubernetes.core.k8s:
    state: present
    definition: "{{ item }}"
  loop: "{{ lookup('fileglob', 'roles/apps/manifests/*.yaml') }}"
  when: nginx|default(false)|bool == true

- name: Remove nginx
  kubernetes.core.k8s:
    state: absent
    definition: "{{ item }}"
  loop: "{{ lookup('fileglob', 'roles/apps/manifests/*.yaml') }}"
  when: nginx|default(false)|bool == false